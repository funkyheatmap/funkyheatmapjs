{"mappings":"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","sources":["vignettes/scIB.js"],"sourcesContent":["import * as d3 from 'd3';\n\nimport funkyheatmap from '../src/main';\nimport { rowToColData } from '../src/input_util';\n\nif (module.hot) {\n    module.hot.accept(() => {\n        window.location.reload();\n    });\n}\n\nfunction prepareData(data) {\n    const SCALING_LABELS = {\n        'Unscaled': '–',\n        'Scaled': '+'\n    };\n    const FEATURES_LABELS = {\n        'Full': 'FULL',\n        'HVG': 'HVG'\n    };\n    const OUTPUT_IMG = {\n        'Features': 'matrix.png',\n        'Embedding': 'embedding.png',\n        'Graph': 'graph.png'\n    };\n\n    data.forEach((item, idx) => {\n        item.id = (idx + 1).toString();\n        item.scaling = SCALING_LABELS[item.scaling];\n        item.features = FEATURES_LABELS[item.features];\n        item.output_img = OUTPUT_IMG[item.output];\n    });\n\n    data = rowToColData(data);\n\n    const RANKS = {\n        'rank_pancreas': 'label_pancreas',\n        'rank_lung_atlas': 'label_lung_atlas',\n        'rank_immune_cell_hum': 'label_immune_cell_hum',\n        'rank_immune_cell_hum_mou': 'label_immune_cell_hum_mou',\n        'rank_mouse_brain': 'label_mouse_brain',\n        'rank_simulations_1_1': 'label_simulations_1_1',\n        'rank_simulations_2': 'label_simulations_2',\n        'package_rank': 'package_label',\n        'paper_rank': 'paper_label',\n        'time_rank': 'time_label',\n        'memory_rank': 'memory_label'\n    };\n\n    function labelTop3(vector) {\n        // d3.rank behaves like R `rank` with `ties.method = \"min\"`\n        let ranks = d3.rank(vector.map(i => +i));\n        return ranks.map(rank => {\n            if (rank < 3) {\n                return (rank + 1).toString();\n            }\n            return '';\n        })\n    }\n\n    for (let [rank, label] of Object.entries(RANKS)) {\n        data[label] = labelTop3(data[rank]);\n        const [min, max] = d3.extent(data[rank].map(i => +i));\n        data[rank] = data[rank].map(x => 1 - (x - min) / (max - min));\n    }\n\n    return data;\n}\n\nconst column_info = [\n    {id: \"id\", name: \"Rank\", geom: \"text\", group: \"Method\", options: {align: \"right\"}},\n    {id: \"method\", name: \"Method\", geom: \"text\", group: \"Method\"},\n    {id: \"output_img\", name: \"Output\", geom: \"image\", group: \"Method\", options: {width: 20}},\n    {id: \"features\", id_color: \"features\", name: \"Features\", geom: \"text\", group: \"Method\", options: {palette: \"features\"}},\n    {id: \"scaling\", name: \"Scaling\", geom: \"text\", group: \"Method\", options: {fontSize: 18, align: \"center\"}},\n    {id: \"overall_pancreas\", id_color: \"rank_pancreas\", name: \"Pancreas\", geom: \"bar\", group: \"RNA\", id_label: \"label_pancreas\", options: {palette: \"blues\", width: 1.5, draw_outline: false}},\n    {id: \"overall_lung_atlas\", id_color: \"rank_lung_atlas\", name: \"Lung\", geom: \"bar\", group: \"RNA\", id_label: \"label_lung_atlas\", options: {palette: \"blues\", width: 1.5, draw_outline: false}},\n    {id: \"overall_immune_cell_hum\", id_color: \"rank_immune_cell_hum\", name: \"Immune (human)\", geom: \"bar\", group: \"RNA\", id_label: \"label_immune_cell_hum\", options: {palette: \"blues\", width: 1.5, draw_outline: false}},\n    {id: \"overall_immune_cell_hum_mou\", id_color: \"rank_immune_cell_hum_mou\", name: \"Immune (human/mouse)\", geom: \"bar\", group: \"RNA\", id_label: \"label_immune_cell_hum_mou\", options: {palette: \"blues\", width: 1.5, draw_outline: false}},\n    {id: \"overall_mouse_brain\", id_color: \"rank_mouse_brain\", name: \"Mouse brain\", geom: \"bar\", group: \"RNA\", id_label: \"label_mouse_brain\", options: {palette: \"blues\", width: 1.5, draw_outline: false}},\n    {id: \"overall_simulations_1_1\", id_color: \"rank_simulations_1_1\", name: \"Sim 1\", geom: \"bar\", group: \"Simulations\", id_label: \"label_simulations_1_1\", options: {palette: \"greens\", width: 1.5, draw_outline: false}},\n    {id: \"overall_simulations_2\", id_color: \"rank_simulations_2\", name: \"Sim 2\", geom: \"bar\", group: \"Simulations\", id_label: \"label_simulations_2\", options: {palette: \"greens\", width: 1.5, draw_outline: false}},\n    {id: \"package_score\", id_color: \"package_rank\", name: \"Package\", geom: \"bar\", group: \"Usability\", id_label: \"package_label\", options: {palette: \"oranges\", width: 1.5, draw_outline: false}},\n    {id: \"paper_score\", id_color: \"paper_rank\", name: \"Paper\", geom: \"bar\", group: \"Usability\", id_label: \"paper_label\", options: {palette: \"oranges\", width: 1.5, draw_outline: false}},\n    {id: \"time_score\", id_color: \"time_rank\", name: \"Time\", geom: \"bar\", group: \"Scalability\", id_label: \"time_label\", options: {palette: \"greys\", width: 1.5, draw_outline: false}},\n    {id: \"memory_score\", id_color: \"memory_rank\", name: \"Memory\", geom: \"bar\", group: \"Scalability\", id_label: \"memory_label\", options: {palette: \"greys\", width: 1.5, draw_outline: false}}\n];\n\nconst column_groups = [\n    {level1: \"Method\", group: \"Method\", palette: \"black\"},\n    {level1: \"RNA\", group: \"RNA\", palette: \"blues\"},\n    {level1: \"Simulations\", group: \"Simulations\", palette: \"greens\"},\n    {level1: \"Usability\", group: \"Usability\", palette: \"oranges\"},\n    {level1: \"Scalability\", group: \"Scalability\", palette: \"greys\"}\n];\n\nconst palettes = {\n    features: {colors: [\"#4c4c4c\", \"#006300\"], names: ['FULL', 'HVG']},\n    blues: \"Blues\",\n    greens: \"Greens\",\n    oranges: [\"#7F2704\", \"#A63603\", \"#D94801\", \"#F16913\", \"#FD8D3C\", \"#FDAE6B\", \"#FDD0A2\", \"#FEE6CE\", \"#FFF5EB\"],\n    greys: \"Greys\",\n    black: [\"black\", \"black\"]\n};\n\nconst legends = [\n    {\n        title: \"Output\",\n        geom: \"image\",\n        size: 20,\n        values: [\"matrix.png\", \"embedding.png\", \"graph.png\"],\n        labels: [\"Genes\", \"Embedding\", \"Graph\"],\n    },\n    {\n        title: \"Scaling\",\n        geom: \"text\",\n        values: [\"Scaled\", \"Unscaled\"],\n        labels: [\"+\", \"–\"],\n    },\n    {\n        title: \"RNA rank\",\n        palette: \"blues\",\n        geom: \"rect\",\n        labels: [\"20\", \"\", \"10\", \"\", \"1\"],\n        size: [1, 1, 1, 1, 1]\n    },\n    {\n        title: \"Simulations rank\",\n        palette: \"greens\",\n        geom: \"rect\",\n        labels: [\"20\", \"\", \"10\", \"\", \"1\"],\n        size: [1, 1, 1, 1, 1]\n    },\n    {\n        title: \"Usability rank\",\n        palette: \"oranges\",\n        geom: \"rect\",\n        labels: [\"20\", \"\", \"10\", \"\", \"1\"],\n        size: [1, 1, 1, 1, 1]\n    },\n    {\n        title: \"Scalability rank\",\n        palette: \"greys\",\n        geom: \"rect\",\n        labels: [\"20\", \"\", \"10\", \"\", \"1\"],\n        size: [1, 1, 1, 1, 1]\n    }\n];\n\nd3.csv('scib_summary.csv').then((data) => {\n    data = prepareData(data);\n\n    d3.select(\"#app\").node().appendChild(funkyheatmap(\n        data,\n        column_info,\n        undefined, // row info\n        column_groups,\n        undefined, // row groups\n        palettes,\n        legends, // legends\n        {rowHeight: 28}, // position options\n        { // heatmap options\n            labelGroupsAbc: false,\n            colorByRank: false\n        },\n        false // scaleColumn\n    ));\n});\n"],"names":["$3gsfO","parcelRequire","$653d24b234bd1d82$var$column_info","id","name","geom","group","options","align","width","id_color","palette","fontSize","id_label","draw_outline","$653d24b234bd1d82$var$column_groups","level1","$653d24b234bd1d82$var$palettes","features","colors","names","blues","greens","oranges","greys","black","$653d24b234bd1d82$var$legends","title","size","values","labels","csv","then","data","SCALING_LABELS","Unscaled","Scaled","FEATURES_LABELS","Full","HVG","OUTPUT_IMG","Features","Embedding","Graph","forEach","item","idx","toString","scaling","output_img","output","$kwarp","rowToColData","RANKS","rank_pancreas","rank_lung_atlas","rank_immune_cell_hum","rank_immune_cell_hum_mou","rank_mouse_brain","rank_simulations_1_1","rank_simulations_2","package_rank","paper_rank","time_rank","memory_rank","rank","label","Object","entries","vector","map","i","min","max","extent","x","$653d24b234bd1d82$var$prepareData","select","node","appendChild","$3JaYo","default","undefined","rowHeight","labelGroupsAbc","colorByRank"],"version":3,"file":"scIB.79f7d164.js.map"}